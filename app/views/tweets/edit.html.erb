<!-- app/views/tweets/edit.html.erb -->
<div class="new-post">
  <div class="new-post__card">
    <div class="new-post__titlebar">ãƒ¬ã‚·ãƒ”ã‚’ç·¨é›†</div>

    <%= form_for @tweet, html: { class: "new-post__form", multipart: true } do |f| %>

      <!-- ç”»åƒã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆã‚¨ãƒ©ãƒ¼ã§æˆ»ã£ãŸæ™‚ã«ä¿æŒï¼‰ -->
      <%= f.hidden_field :image_cache %>

      <!-- ã‚¿ã‚¤ãƒˆãƒ« -->
      <section class="np-section">
        <p class="np-label">ã‚¿ã‚¤ãƒˆãƒ«</p>
        <%= f.text_field :title, placeholder: "ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›", class: "np-input" %>
      </section>

      <!-- æ–™ç†ã®å†™çœŸ -->
      <section class="np-section">
        <p class="np-label">æ–™ç†ã®å†™çœŸ</p>
        <div id="new-image">
          <label class="np-photo">
            <%= f.file_field :image,
                  accept: "image/*",
                  class: "np-photo__input",
                  onchange: "previewNewImage(event)" %>

            <div class="np-photo__dummy">
              <%# æ—¢å­˜ç”»åƒãŒã‚ã‚Œã°è¡¨ç¤ºã€ãªã‘ã‚Œã°ãƒ€ãƒŸãƒ¼ %>
              <img id="preview-img"
                   src="<%= @tweet.image? ? @tweet.image.url : '' %>"
                   class="new-img"
                   style="<%= @tweet.image? ? '' : 'display:none;' %>">

              <% unless @tweet.image? %>
                <div class="np-photo__icon">ğŸ“·</div>
                <p>æ–™ç†ã®å†™çœŸã‚’ã®ã›ã‚‹</p>
              <% end %>
            </div>
          </label>
        </div>
      </section>


      <!-- ææ–™ -->
      <section class="np-section">
        <p class="np-label">ææ–™</p>
        <%= f.text_area :material, placeholder: "ææ–™ã‚’å…¥åŠ›", class: "np-input np-textarea" %>
      </section>

      <!-- ä½œã‚Šæ–¹ -->
      <section class="np-section">
        <p class="np-label">ä½œã‚Šæ–¹</p>
        <%= f.text_area :recipe, placeholder: "ä½œã‚Šæ–¹ã‚’å…¥åŠ›", class: "np-input np-textarea" %>
      </section>

      <!-- ä½•äººå‰ -->
      <section class="np-section">
        <p class="np-label">ä½•äººå‰</p>
        <div style="display:flex; gap:8px; align-items:center; width:90%; max-width:660px; margin:0 auto;">
          <%= f.number_field :servings, class: "np-input", min: 1, max: 20, placeholder: "ä¾‹ï¼š2" %>
          <span>äººå‰</span>
        </div>
      </section>


      <!-- èª¿ç†æ™‚é–“ -->
      <section class="np-section time-section">
        <p class="np-label">èª¿ç†æ™‚é–“</p>
        <%= f.text_field :time, placeholder: "ä¾‹ï¼š20åˆ†", class: "np-input" %>
      </section>

      <!-- æ˜Ÿè©•ä¾¡ï¼šç·åˆè©•ä¾¡ -->
      <div class="post8-section">
        <div class="post8-label">ç·åˆè©•ä¾¡</div>
        <div class="post_form">
          <%= f.radio_button :overall, 5 ,id: 'star1'%>
          <label for="star1"><span class="text">æœ€é«˜</span>â˜…</label>

          <%= f.radio_button :overall, 4 ,id: 'star2'%>
          <label for="star2"><span class="text">è‰¯ã„</span>â˜…</label>

          <%= f.radio_button :overall, 3 ,id: 'star3'%>
          <label for="star3"><span class="text">æ™®é€š</span>â˜…</label>

          <%= f.radio_button :overall, 2 ,id: 'star4'%>
          <label for="star4"><span class="text">æ‚ªã„</span>â˜…</label>

          <%= f.radio_button :overall, 1 ,id: 'star5'%>
          <label for="star5"><span class="text">æœ€æ‚ª</span>â˜…</label>
        </div>
      </div>

      <!-- æ˜Ÿè©•ä¾¡ï¼šæˆæ¥­ãƒ¬ãƒ™ãƒ« -->
      <div class="post9-section">
        <div class="post9-label">åˆå¿ƒè€…ã«ãŠã™ã™ã‚</div>
        <div class="post_form">
          <%= f.radio_button :level,  5 ,id: 'star6'%>
          <label for="star6"><span class="text">ç°¡å˜</span>â˜…</label>

          <%= f.radio_button :level,  4 ,id: 'star7'%>
          <label for="star7"><span class="text">ã‚„ã‚„ç°¡å˜</span>â˜…</label>

          <%= f.radio_button :level, 3 ,id: 'star8'%>
          <label for="star8"><span class="text">æ™®é€š</span>â˜…</label>

          <%= f.radio_button :level , 2 ,id: 'star9'%>
          <label for="star9"><span class="text">ã‚„ã‚„é›£ã—ã„</span>â˜…</label>

          <%= f.radio_button :level , 1 ,id: 'star10'%>
          <label for="star10"><span class="text">é›£ã—ã„</span>â˜…</label>
        </div>
      </div>

      <!-- ãƒ¬ã‚·ãƒ”ã®ç´¹ä»‹ -->
      <section class="np-section">
        <p class="np-label">ãƒ¬ã‚·ãƒ”ã®ç´¹ä»‹</p>
        <%= f.text_area :comment, placeholder: "ãƒ¬ã‚·ãƒ”ã®æ¦‚è¦ã‚„æ„Ÿæƒ³ã‚’å…¥åŠ›", class: "np-input np-textarea" %>
      </section>

      <!-- é€ä¿¡ -->
      <footer class="np-footer">
        <%= f.submit "ãƒ¬ã‚·ãƒ”ã‚’æ›´æ–°ã™ã‚‹", class: "np-btn" %>
      </footer>
    <% end %>
  </div>
</div>

<script>
  // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠæ™‚ã«å³æ™‚ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
  function previewNewImage(e){
    const file = e.target.files[0];
    if(!file) return;
    const reader = new FileReader();
    reader.onload = function(ev){
      const img = document.getElementById('preview-img');
      img.src = ev.target.result;
      img.style.display = 'block';
    };
    reader.readAsDataURL(file);
  }
</script>